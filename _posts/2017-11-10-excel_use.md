---
title: "Getting started with Excel"
author: "John Ray"
date: "November 9, 2017"
layout: post

output: 
  md_document:
    variant: markdown_github
---

In this tutorial, we will walk through the following common uses of Microsoft Excel:

-   The relative reference system
-   The `$` operator, known as the 'lock' operator in Excel parlance
-   Using Excel to produce simple charts

I will be using an open-source alternative to Excel called LibreOffice, but the functionality and formulas are identical. In this tutorial, I will present basic use cases of the most important basic functionality of Excel. No prior knowledge of Excel is assumed, and no Visual Basic (the language for coding macros) is included. Readers are invited to follow along with their own data.

### The relative reference system

One feature to note about the way Excel organizes data is that each cell can be found using a two-coordinate system similar to that of a a Battleship board: Each cell has a position in a column (labeled from A A through Z, then AA through ZZ, and so on) and a position in a row. For example, in the figure below, the cell referenced at `A1` contains the character string, "Hello, world!"

![A sample character strign in cell A1.](figure/s1.png)

If I want to get the contents of that cell, I tell Excel that I want the contents of cell `A1`.

![](figure/s2a.png)

![](figure/s2b.png)

![](figure/s2c.png)

Note that I use the `=` operator to tell Excel that I want a reference to *cell* `A1` rather than, say, just to write the text string "A1." `=A1` would return the contents of cell `A1`, simply writing `A1` would just create a cell that contains the phrase "A1."

The `=` operator is a convenient feature of Excel because it allows us to work with our data without editing the data in place. For example, lets say I have two columns of numeric data and I want to create a new variable defined as the difference between each of the columns. Here, say I have the results of two theoretical elections for Democratic candidates and I want to compute the difference between the two. Here, note that the data is stored in column A, row 1 through column C, row 6. In Excel parlance we write this as \`A1:C6,' said out loud as "A1 through C6."

![](figure/s3.png)

To compute the difference between each column I'll simply go to the next column, assign a new column name, and write the formula in the first cell in the row that contains data.

![](figure/s4.png)

![](figure/s5.png)

Then, instead of doing the same thing in every cell, I can simply click on the small box in the lower-right-hand corner of my data and drag down to complete the new variable.

![](figure/s6.png)

![](figure/s7.png)

![](figure/s8.png)

And note that Excel knows to change the cell of reference from the cell we started at to the next cell *down*, to the next cell down from that, etc., because we dragged our formula *down* as well.

![](figure/s9.png)

I refer to Excel's clig-and-drag approach to implementing formulas as the "relative reference" system because doing so implies that the calculations you're running are relative to the cells to which your formulas refer. (Nobody cares where the term comes from, I just thought I'd say it) But now lets consider a slightly different problem. Consider a case where I have a large amount of raw data, some of which shares a common denominator but not a common numerator. Here, the data in column `A` includes the names of states, `B` contains raw votes for a theoretical Democratic candidate in a theoretical election, `C` contains raw votes for a theoretical Rebublican, and `D` contains raw votes for other parties. Then we have a blank column, and a column containing what appear to be the total votes for each election.

![](figure/s10.png)

Most likely, the analysis I'm conducting will be more concerned with what *percent* of the vote each party earned rather than vote totals. (I mean, not necessarily, but probably so) But if I try to just click and drag as with the previous example, I successfully compute the Democratic percentage in the first column, but the other two will break.

![](figure/s11a.png)

![](figure/s11b.png)

![](figure/s11c.png)

What's going on? When we click and drag *down* Excel computes our formula for the next cell down, but when we drag over to the right also computes the formula for the next cell *over*. Look at the vision Excel is trying to do in the columns for `reppct` and `othpct`.

![](figure/s12a.png)

![](figure/s12b.png)

To remedy the automatic movement of the relative reference, we will use the 'lock' operator, or $.

### The lock operator

In Excel, the '$' operator halts the movement of a relative reference either from row to row, column to column, or both. If I want to click and drag and have Excel follow me just from rows but not columns, for example, I can force Excel to refer to the same column as I drag over by "locking" the column.

In our example, I want Excel to divide every cell in a 4x3 table, our party vote data, by every cell in a 4x1 table, our total vote data. As I move from column 1 of the party vote data to column 2 to column 3, I want the denominator of the function to remain in column 1 of the 4x1 table of total votes. This is referred to as "locking" the data that will go into the denominator.

To do so, I use the `$` to lock the column side of the relative reference. Instead of starting by writing `=F2` to reference the first cell in the total data, I write `$F2`. Now, when I click and drag, the *row* portion of the formula is free to move, while the *column* portion of the formula is not.

![](figure/s13a.png)

![](figure/s13b.png)

![](figure/s13c.png)

Likewise, notice that we didn't actually need that column of vote totals to make this calculation. We could compute each party's vote percent in each state by dividing each party's individual counts by `dem + rep + oth`. The easiest way to do so would be to write the formula once, lock the columns using the `$` operator, then click and drag.

![](figure/s14a.png)

![](figure/s14b.png)

![](figure/s14c.png)

Then, if I want to place that data in a new column beside my original data, I will select all of it, copy (`ctrl + c` on Windows and `apple + c` on), select the first cell I want to paste in, right click, select `Paste Special` and paste in the *values* rather than the *formula.* We do this to deactivate relative referencing - copying-and-pasting and clicking-and dragging-both use relative referencing by default.

![](figure/s15a.png)

![](figure/s15b.png)

![](figure/s15c.png)

![](figure/s15d.png)

![](figure/s15e.png)

![](figure/s15f.png)

![](figure/s15g.png)

Likewise, if I wanted to find what percent of each party's total votes came from each state, I would lock the rows but not the columns.

![](figure/s17a.png)

![](figure/s17b.png)

![](figure/s17c.png)

And if I wanted to find what percent of *all* votes in that election went to each state in each party, I would lock both the rows and the columns.

![](figure/s18a.png)

![](figure/s18b.png)

![](figure/s18c.png)

### Making charts

Making charts in Excel is straightforward with the exception of the way Excel deals with labels. The capacity of Excel to intelligently divine desired labels for variables, series, etc., varies greatly from version to version, but in general getting the labels you want requires a little fidding. From our example, lets say I want to plot party vote percent by state. All I would have to do is select my data and insert a chart into my spreadsheet.

![](figure/s19a.png)

![](figure/s19b.png)

![](figure/s19c.png)

![](figure/s19d.png)

![](figure/s19e.png)

Getting started is easy, but this looks nothing like what we want! The state labels are simply `1, 2, 3, 4`, my variable names are ugly and so is the color scheme, and the y-axis is reporting a decimal value rather than a percent, which is more visually appealing for this particular problem.

Typically, I find it easiest to simply paste the data I wish to plot to a new place so that I can make a specially formatted version of it that will look nice when plotted, without risking messing up my original raw data. Here, I simply copy-paste my data down to a new spot on the same sheet, and then manually change certain values to suit my tastes.

![](figure/s20a.png)

![](figure/s20b.png)

![](figure/s20c.png)

![](figure/s20d.png)

![](figure/s20e.png)

![](figure/s20f.png)

![](figure/s20g.png)

![](figure/s20h.png)

![](figure/s20i.png)

![](figure/s20j.png)

![](figure/s20k.png)

![](figure/s20l.png)

![](figure/s20m.png)

I gloss over the coloring portion of the final two panes because there is great variation in the specifics of customizing colors, titles, etc., from Excel version to Excel version. I chose colors that correspond to those of the major parties, and gray for the third parties.
